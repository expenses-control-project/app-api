generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Usuarios {
  idUsuario     Int             @id @default(autoincrement())
  nombre        String
  apellido      String
  edad          Float  
  email         String          @unique
  usuario       String          @unique
  password      String
  role          ROLES           @default(USUARIO)
  acceso        ACCES_LEVEL     @default(BASIC)

}

model Cuentas {
  idCuenta     Int       @id @default(autoincrement())
  nombre       String    @unique
  descripcion  String
  saldo        Float
  ingresoList  Ingresos[]
  gastoCuenta  GastosCuentas[] // Relación con la tabla asociativa de Gastos
}

model Establecimientos {
  idEstablecimiento      Int       @id @default(autoincrement())
  nombreEstablecimiento  String    @unique
  idRubro                Int
  rubro                  Rubros    @relation(fields: [idRubro], references: [idRubro])
  gastoList              Gastos[]
}

model Gastos {
  idGasto           Int                @id @default(autoincrement())
  descripcion       String
  monto             Float
  fecha             DateTime
  idEstablecimiento Int
  establecimiento   Establecimientos    @relation(fields: [idEstablecimiento], references: [idEstablecimiento])
  cuentaList        GastosCuentas[]     // Relación con la tabla asociativa con Cuentas
}

model GastosCuentas {                   // Tabla asociativa para la relación Gastos <-> Cuentas
  idGasto    Int
  idCuenta   Int
  gasto      Gastos   @relation(fields: [idGasto], references: [idGasto])
  cuenta     Cuentas  @relation(fields: [idCuenta], references: [idCuenta])

  @@id([idGasto, idCuenta])              // Llave primaria compuesta
}

model Ingresos {
  idIngreso      Int     @id @default(autoincrement())
  saldo          Float
  fecha          DateTime
  idCuenta       Int
  cuenta         Cuentas @relation(fields: [idCuenta], references: [idCuenta])
}

model Rubros {
  idRubro             Int               @id @default(autoincrement())
  nombreRubro         String            @unique
  establecimientoList Establecimientos[]
}

enum ROLES {
  USUARIO
  ADMIN
}

enum ACCES_LEVEL {
  BASIC 
  MANTEINER
  OWNER
}
